generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Department {
  id         Int         @id @default(autoincrement())
  name       String      @unique
  employees  Employee[]
}

model Employee {
  id          Int         @id @default(autoincrement())
  lastName    String
  firstName   String
  postLinkId  String      @unique
  department  Department? @relation(fields: [departmentId], references: [id])
  departmentId Int?
  trainingResults TrainingResult[]
}

model TaskGroup {
  id     Int    @id @default(autoincrement())
  name   String @unique
  tasks  Task[]
}

model Task {
  id          Int        @id @default(autoincrement())
  title       String
  description String
  command     String
  hint        String
  group       TaskGroup? @relation(fields: [groupId], references: [id])
  groupId     Int?
}

model TrainingResult {
  id              Int       @id @default(autoincrement())
  employee        Employee  @relation(fields: [employeeId], references: [id])
  employeeId      Int
  sessionId       String    // Unique identifier for each training session
  totalTasks      Int
  correctAnswers  Int
  incorrectAnswers Int
  completedAt     DateTime  @default(now())
  
  @@index([employeeId])
  @@index([sessionId])
}


